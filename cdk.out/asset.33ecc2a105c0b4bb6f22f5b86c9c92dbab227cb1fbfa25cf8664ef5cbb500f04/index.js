"use strict";var n=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var g=Object.getOwnPropertyNames;var d=Object.prototype.hasOwnProperty;var h=(s,e)=>{for(var r in e)n(s,r,{get:e[r],enumerable:!0})},y=(s,e,r,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of g(e))!d.call(s,o)&&o!==r&&n(s,o,{get:()=>e[o],enumerable:!(t=u(e,o))||t.enumerable});return s};var k=s=>y(n({},"__esModule",{value:!0}),s);var p={};h(p,{handler:()=>m});module.exports=k(p);var m=async s=>{if(s.resource==="/auth/session/verify"){let e=s.headers.Cookie||s.headers.cookie;return{statusCode:200,headers:{"Access-Control-Allow-Origin":process.env.ALLOWED_ORIGIN||"*","Access-Control-Allow-Credentials":"true"},body:JSON.stringify({cookiesPresent:!!e,cookies:e?O(e):null})}}try{if(!s.body)return{statusCode:400,body:JSON.stringify({message:"Missing request body"})};let{accessToken:e,idToken:r}=JSON.parse(s.body);if(console.log("Received tokens:",{accessTokenLength:e?.length,idTokenLength:r?.length}),!e||!r)return{statusCode:400,body:JSON.stringify({message:"Missing required tokens"})};let t={httpOnly:!0,secure:!0,sameSite:"strict",maxAge:24*60*60*1e3,path:"/"},o=[`accessToken=${e}; ${c(t)}`,`idToken=${r}; ${c(t)}`];console.log("Setting cookies:",o);let a=(process.env.ALLOWED_ORIGIN||"").split(","),i=s.headers.origin||s.headers.Origin,l=i&&a.includes(i)?i:a[0];return{statusCode:200,headers:{"Set-Cookie":o.join("; "),"Access-Control-Allow-Origin":l,"Access-Control-Allow-Credentials":"true"},body:JSON.stringify({success:!0,cookiesSet:o.length})}}catch(e){return console.error("Session management error:",e),{statusCode:500,body:JSON.stringify({message:"Internal server error"})}}};function O(s){return s.split(";").map(e=>e.trim()).reduce((e,r)=>{let[t,o]=r.split("=");return e[t]=o,e},{})}function c(s){let e=[];return s.httpOnly&&e.push("HttpOnly"),s.secure&&e.push("Secure"),s.sameSite&&e.push(`SameSite=${s.sameSite}`),s.maxAge&&e.push(`Max-Age=${Math.floor(s.maxAge/1e3)}`),s.domain&&e.push(`Domain=${s.domain}`),s.path&&e.push(`Path=${s.path}`),e.join("; ")}0&&(module.exports={handler});
//# sourceMappingURL=index.js.map
