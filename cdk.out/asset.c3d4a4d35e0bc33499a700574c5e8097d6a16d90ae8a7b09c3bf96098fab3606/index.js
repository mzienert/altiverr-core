"use strict";var i=Object.defineProperty;var c=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var d=Object.prototype.hasOwnProperty;var g=(e,s)=>{for(var t in s)i(e,t,{get:s[t],enumerable:!0})},y=(e,s,t,o)=>{if(s&&typeof s=="object"||typeof s=="function")for(let r of u(s))!d.call(e,r)&&r!==t&&i(e,r,{get:()=>s[r],enumerable:!(o=c(s,r))||o.enumerable});return e};var A=e=>y(i({},"__esModule",{value:!0}),e);var m={};g(m,{handler:()=>h});module.exports=A(m);var h=async e=>{let s=e.headers.origin||e.headers.Origin,t=(process.env.ALLOWED_ORIGIN||"").split(","),o=s&&t.includes(s)?s:t[0];try{if(!e.body)return{statusCode:400,headers:{"Access-Control-Allow-Origin":o,"Access-Control-Allow-Credentials":"true"},body:JSON.stringify({message:"Missing request body"})};let{accessToken:r,idToken:n}=JSON.parse(e.body);if(!r||!n)return{statusCode:400,headers:{"Access-Control-Allow-Origin":o,"Access-Control-Allow-Credentials":"true"},body:JSON.stringify({message:"Missing required tokens"})};let a={httpOnly:!0,secure:!0,sameSite:"strict",maxAge:24*60*60*1e3};return{statusCode:200,headers:{"Set-Cookie":[`accessToken=${r}; ${l(a)}`,`idToken=${n}; ${l(a)}`].join("; "),"Access-Control-Allow-Origin":o,"Access-Control-Allow-Credentials":"true"},body:JSON.stringify({success:!0})}}catch{return{statusCode:500,headers:{"Access-Control-Allow-Origin":o,"Access-Control-Allow-Credentials":"true"},body:JSON.stringify({message:"Internal server error"})}}};function l(e){let s=[];return e.httpOnly&&s.push("HttpOnly"),e.secure&&s.push("Secure"),e.sameSite&&s.push(`SameSite=${e.sameSite}`),e.maxAge&&s.push(`Max-Age=${Math.floor(e.maxAge/1e3)}`),e.domain&&s.push(`Domain=${e.domain}`),e.path&&s.push(`Path=${e.path}`),s.join("; ")}0&&(module.exports={handler});
//# sourceMappingURL=index.js.map
